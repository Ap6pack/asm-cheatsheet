# Nmap Scan Profiles for ASM
# Optimized scanning configurations for different scenarios

# Quick Discovery Scan
# Fast scan for live host detection
[quick_discovery]
flags = -sn -PS21,22,23,25,80,443,445,3389,8080,8443
timing = -T4
output = -oA quick_discovery
description = "Fast ping sweep for live host detection"

# Basic Port Scan
# Standard port scan with service detection
[basic_ports]
flags = -sS -sV -sC
ports = --top-ports 1000
timing = -T3
output = -oA basic_ports
description = "Top 1000 ports with service/version detection"

# Full TCP Scan
# Comprehensive TCP port scan
[full_tcp]
flags = -sS -sV -sC -A
ports = -p-
timing = -T2
output = -oA full_tcp
max_retries = --max-retries 2
min_rate = --min-rate 100
max_rate = --max-rate 500
description = "Full TCP port scan with OS and service detection"

# Web Services Scan
# Focus on web-related ports
[web_services]
flags = -sS -sV -sC
ports = -p 80,443,8080,8443,8000,8888,3000,5000,9000,9090,9443
timing = -T3
scripts = --script http-headers,http-title,http-methods,ssl-cert
output = -oA web_services
description = "Web services focused scan"

# Vulnerability Scan
# Check for common vulnerabilities
[vulnerability]
flags = -sS -sV
ports = --top-ports 1000
timing = -T3
scripts = --script vuln,exploit
output = -oA vulnerability
description = "Vulnerability detection scan"

# Stealth Scan
# Low and slow for evasion
[stealth]
flags = -sS -sV
ports = --top-ports 100
timing = -T1
fragmentation = -f
decoy = -D RND:10
spoof_mac = --spoof-mac 0
output = -oA stealth
description = "Stealthy scan with evasion techniques"

# UDP Scan
# Common UDP services
[udp_services]
flags = -sU -sV
ports = -p 53,67,68,69,123,161,162,500,514,520,1900
timing = -T3
output = -oA udp_services
description = "Common UDP services scan"

# Database Scan
# Database service discovery
[databases]
flags = -sS -sV -sC
ports = -p 1433,1521,3306,5432,5984,6379,7000,7001,8086,9042,9200,9300,27017
timing = -T3
scripts = --script ms-sql-info,mysql-info,mongodb-info
output = -oA databases
description = "Database services scan"

# SMB/NetBIOS Scan
# Windows services enumeration
[smb_netbios]
flags = -sS -sV -sC
ports = -p 135,139,445
timing = -T3
scripts = --script smb-enum-shares,smb-enum-users,smb-os-discovery
output = -oA smb_netbios
description = "SMB and NetBIOS enumeration"

# Mail Services Scan
# Email server enumeration
[mail_services]
flags = -sS -sV -sC
ports = -p 25,110,143,465,587,993,995
timing = -T3
scripts = --script smtp-commands,smtp-enum-users,imap-capabilities,pop3-capabilities
output = -oA mail_services
description = "Mail services enumeration"

# Custom ASM Scan
# Balanced scan for ASM purposes
[asm_default]
flags = -sS -sV -sC -O
ports = --top-ports 5000
timing = -T3
output = -oA asm_scan
max_retries = --max-retries 3
min_rate = --min-rate 200
max_rate = --max-rate 1000
scripts = --script discovery,vuln
exclude_ports = --exclude-ports 9100-9107
description = "Default ASM scanning profile"

# Aggressive Scan
# Maximum information gathering
[aggressive]
flags = -sS -sV -sC -A -O
ports = -p-
timing = -T4
scripts = --script default,discovery,vuln,exploit
output = -oA aggressive
max_retries = --max-retries 5
min_rate = --min-rate 500
description = "Aggressive scan with all features"

# IPv6 Scan
# IPv6 specific scanning
[ipv6]
flags = -6 -sS -sV
ports = --top-ports 1000
timing = -T3
output = -oA ipv6_scan
description = "IPv6 network scanning"

# Firewall Detection
# Identify firewall rules
[firewall_detect]
flags = -sA
ports = --top-ports 100
timing = -T3
output = -oA firewall_detect
description = "ACK scan for firewall detection"

# Service Version Intensity
# Deep service fingerprinting
[version_intense]
flags = -sV
version_intensity = --version-intensity 9
ports = --top-ports 1000
timing = -T3
output = -oA version_intense
description = "Intensive service version detection"

# Global Settings
[global]
# DNS resolution
dns = -n
# Exclude RFC1918 ranges (optional)
# exclude = --exclude 10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# Custom NSE script directory
script_dir = --datadir /opt/nmap/scripts
# Increase verbosity
verbose = -v
# Save all formats
output_all = -oA
# Resume scan
resume = --resume
# Host timeout
host_timeout = --host-timeout 30m
# Script timeout
script_timeout = --script-timeout 10m
# Max parallelism
max_parallelism = --max-parallelism 100
# Min hostgroup
min_hostgroup = --min-hostgroup 64
# Max hostgroup
max_hostgroup = --max-hostgroup 256
